---
name: word-to-h5-agreement
description: 将Word格式的法律协议文档（用户协议、隐私协议、法律条款）转换为美观的响应式H5页面。仅处理用户指定的单个文件，不联想生成其他文件。当用户请求：转换指定Word文件为HTML、查看Word文档的H5效果、在浏览器中预览Word协议时使用此技能。
---

# Word协议文档转H5页面

将指定的Word文档转换为美观的响应式H5页面，生成在与Word文件相同的目录下。

## 依赖安装

首次使用前安装依赖：

```bash
pip install python-docx
```

或使用 requirements.txt：

```bash
pip install -r requirements.txt
```

## 工作流程

### 1. 读取Word文档

使用 `scripts/convert-docx.py` 脚本转换用户指定的Word文档：

```bash
python scripts/convert-docx.py /path/to/document.docx
```

**重要规则**：
- 只处理用户明确指定的单个文件
- 生成的HTML文件与Word文件在同一目录
- HTML文件名：`[英文名称]-[生效日期].html`
  - 隐私协议 → `privacy-policy-YYYYMMDD.html`
  - 儿童隐私保护 → `children-privacy-YYYYMMDD.html`
  - 用户协议 → `user-agreement-YYYYMMDD.html`
  - 生效日期格式化：`2026年1月1日` → `20260101`

### 2. 提取文档内容

脚本会：
- 智能识别文档标题和生效日期
- 严格提取Word文档的所有文本内容
- 保留段落、标题、列表等结构
- 保留文本格式（**加粗**、*斜体*、下划线等）
- 不修改任何文字，不漏字，不改字
- 处理换行、空格等格式细节

**智能识别功能**：
- 自动提取文档第一段作为标题
- 自动识别并提取生效日期
- 智能识别各级标题（中文序号、数字序号、样式名称等）
- 避免标题和日期重复显示

**格式保留**：
- 加粗文本自动转换为 `<strong>` 标签
- 斜体文本自动转换为 `<em>` 标签
- 下划线文本自动转换为 `<u>` 标签
- 超链接文本自动提取并保留（如邮箱、网址等）
- 完整保留Word文档中的文本格式样式

**智能序号修复**：
- 自动检测标题序号的连续性和一致性
- 修复第一个标题缺少序号的情况（如"个人信息的收集和使用" → "1. 个人信息的收集和使用"）
- 修复序号不连续的问题（如1, 3, 4 → 1, 2, 3）
- 统一序号格式（中文序号"一、"统一为数字序号"1."）

### 3. 生成H5页面

自动生成包含以下内容的HTML：
- 完整的文档内容（从Word提取）
- 响应式样式（PC/移动端/小程序）
- 返回顶部按钮
- 底部版权信息
- 底部导航链接（自动使用相同的生效日期）

### 4. 查看效果

生成完成后，提示用户：

```
✅ HTML文件已生成：/绝对路径/document.html

请在浏览器中访问以下地址查看效果：
file:///绝对路径/document.html
```

### 5. 调整样式（可选）

如需调整样式，参考：
- **[styles.md](references/styles.md)** - 样式变量和类定义

## 重要注意事项

### 内容完整性
- 严格对照Word文档内容，不修改任何文字
- 保留所有段落、标题、列表结构
- 保留换行、空格等格式细节
- 不添加、不删除、不修改任何内容

### 文件处理
- 只处理用户指定的单个文件
- HTML文件生成在Word文件所在目录
- 不联想或生成其他文件
- 文件命名规则：英文名称+生效日期（便于部署管理）

### 样式要求
- CSS内联在HTML文件中
- 响应式设计（PC/移动端/小程序）
- 参见 [styles.md](references/styles.md) 的完整样式定义

## 样式参考

详细的样式定义和模板见：

- **[styles.md](references/styles.md)** - 完整CSS样式、颜色方案、响应式断点
- **[template.md](references/template.md)** - HTML结构参考
